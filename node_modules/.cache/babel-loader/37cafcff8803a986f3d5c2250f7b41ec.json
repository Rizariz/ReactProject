{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\61452\\\\Documents\\\\marriage-point-calculator\\\\src\\\\auth\\\\AuthProvider.js\";\nimport React, { useContext, useEffect, useState } from 'react';\nimport { useDispatch } from 'react-redux'; // action\n\nimport { setGameAdmin } from '../features/MarriageSlice.js'; // util\n\nimport { signInWithGmail, auth } from '../firebase.util.js';\nexport const AuthContext = React.createContext();\nexport function useAuth() {\n  return useContext(AuthContext);\n}\nexport function AuthProvider({\n  children\n}) {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const dispatch = useDispatch();\n\n  const login = () => {\n    return signInWithGmail();\n  };\n\n  const logout = () => {\n    return auth.signOut();\n  };\n\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      console.log('entered use effect = ', user);\n      setCurrentUser(user);\n      setLoading(false);\n      user && dispatch(setGameAdmin({\n        adminUid: user.uid,\n        adminName: user.displayName.split(\" \")[0]\n      }));\n    });\n    return unsubscribe;\n  }, [dispatch]);\n\n  const getAuthToken = async () => {\n    let token = \"\";\n    await auth.onAuthStateChanged(user => {\n      token = user.refreshToken;\n    });\n    return token;\n  };\n\n  const value = {\n    login,\n    logout,\n    currentUser,\n    getAuthToken\n  };\n  return /*#__PURE__*/React.createElement(AuthContext.Provider, {\n    value: value,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }\n  }, !loading && children);\n}","map":{"version":3,"sources":["C:/Users/61452/Documents/marriage-point-calculator/src/auth/AuthProvider.js"],"names":["React","useContext","useEffect","useState","useDispatch","setGameAdmin","signInWithGmail","auth","AuthContext","createContext","useAuth","AuthProvider","children","currentUser","setCurrentUser","loading","setLoading","dispatch","login","logout","signOut","unsubscribe","onAuthStateChanged","user","console","log","adminUid","uid","adminName","displayName","split","getAuthToken","token","refreshToken","value"],"mappings":";AAAA,OAAOA,KAAP,IAAcC,UAAd,EAA0BC,SAA1B,EAAoCC,QAApC,QAAmD,OAAnD;AACA,SAAQC,WAAR,QAA0B,aAA1B,C,CAEA;;AACA,SAASC,YAAT,QAA6B,8BAA7B,C,CAEA;;AACA,SAAQC,eAAR,EAAwBC,IAAxB,QAAmC,qBAAnC;AAEA,OAAO,MAAMC,WAAW,GAAGR,KAAK,CAACS,aAAN,EAApB;AAEP,OAAO,SAASC,OAAT,GAAkB;AACrB,SAAOT,UAAU,CAACO,WAAD,CAAjB;AACH;AAED,OAAO,SAASG,YAAT,CAAuB;AAACC,EAAAA;AAAD,CAAvB,EAAkC;AACrC,QAAM,CAACC,WAAD,EAAaC,cAAb,IAA+BX,QAAQ,CAAC,IAAD,CAA7C;AACA,QAAM,CAACY,OAAD,EAASC,UAAT,IAAqBb,QAAQ,CAAC,IAAD,CAAnC;AACA,QAAMc,QAAQ,GAAGb,WAAW,EAA5B;;AAEA,QAAMc,KAAK,GAAE,MAAI;AACb,WAAOZ,eAAe,EAAtB;AACH,GAFD;;AAIA,QAAMa,MAAM,GAAG,MAAI;AACf,WAAOZ,IAAI,CAACa,OAAL,EAAP;AACH,GAFD;;AAIAlB,EAAAA,SAAS,CAAC,MAAI;AACV,UAAMmB,WAAW,GAAGd,IAAI,CAACe,kBAAL,CAAwBC,IAAI,IAAE;AAC9CC,MAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ,EAAoCF,IAApC;AACAT,MAAAA,cAAc,CAACS,IAAD,CAAd;AACAP,MAAAA,UAAU,CAAC,KAAD,CAAV;AACAO,MAAAA,IAAI,IAAIN,QAAQ,CAACZ,YAAY,CAAC;AAACqB,QAAAA,QAAQ,EAACH,IAAI,CAACI,GAAf;AAAmBC,QAAAA,SAAS,EAACL,IAAI,CAACM,WAAL,CAAiBC,KAAjB,CAAuB,GAAvB,EAA4B,CAA5B;AAA7B,OAAD,CAAb,CAAhB;AACD,KALiB,CAApB;AAOA,WAAOT,WAAP;AACH,GATQ,EASP,CAACJ,QAAD,CATO,CAAT;;AAWA,QAAMc,YAAY,GAAG,YAAU;AAC3B,QAAIC,KAAK,GAAG,EAAZ;AACA,UAAMzB,IAAI,CAACe,kBAAL,CAAwBC,IAAI,IAAE;AAChCS,MAAAA,KAAK,GAACT,IAAI,CAACU,YAAX;AACD,KAFG,CAAN;AAGA,WAAOD,KAAP;AACH,GAND;;AAQA,QAAME,KAAK,GAAG;AACVhB,IAAAA,KADU;AAEVC,IAAAA,MAFU;AAGVN,IAAAA,WAHU;AAIVkB,IAAAA;AAJU,GAAd;AAMA,sBACI,oBAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAIG,KAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACK,CAACnB,OAAD,IAAYH,QADjB,CADJ;AAKH","sourcesContent":["import React,{useContext, useEffect,useState} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\n\r\n// action\r\nimport { setGameAdmin } from '../features/MarriageSlice.js';\r\n\r\n// util\r\nimport {signInWithGmail,auth} from '../firebase.util.js';\r\n\r\nexport const AuthContext = React.createContext();\r\n\r\nexport function useAuth(){\r\n    return useContext(AuthContext);\r\n}\r\n\r\nexport function AuthProvider ({children}){\r\n    const [currentUser,setCurrentUser] = useState(null);\r\n    const [loading,setLoading]=useState(true);\r\n    const dispatch = useDispatch();\r\n\r\n    const login= ()=>{\r\n        return signInWithGmail()\r\n    }\r\n\r\n    const logout = ()=>{\r\n        return auth.signOut();\r\n    }\r\n\r\n    useEffect(()=>{\r\n        const unsubscribe = auth.onAuthStateChanged(user=>{\r\n            console.log('entered use effect = ',user)\r\n            setCurrentUser(user)\r\n            setLoading(false)\r\n            user && dispatch(setGameAdmin({adminUid:user.uid,adminName:user.displayName.split(\" \")[0]}))\r\n          })\r\n\r\n        return unsubscribe\r\n    },[dispatch])\r\n\r\n    const getAuthToken = async ()=>{\r\n        let token = \"\"\r\n        await auth.onAuthStateChanged(user=>{\r\n            token=user.refreshToken\r\n          })\r\n        return token\r\n    }\r\n\r\n    const value = {\r\n        login,\r\n        logout,\r\n        currentUser,\r\n        getAuthToken\r\n    }\r\n    return (\r\n        <AuthContext.Provider value = {value}>\r\n            {!loading && children}\r\n        </AuthContext.Provider>\r\n    )\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}